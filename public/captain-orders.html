<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ | ÙˆØµÙ„-Ù„ÙŠ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;900&display=swap" rel="stylesheet">
</head>
<body style="background-color: #f8f9fa;">

    <header>
        <a href="index.html" class="logo"><span>ÙˆØµÙ„-Ù„ÙŠ</span></a>
        <div style="display: flex; align-items: center; gap: 15px;">
            <span id="welcome-msg" style="font-weight: bold; color: var(--secondary);">Ù…Ø±Ø­Ø¨Ø§Ù‹</span>
            <button onclick="logout()" style="background:none; border:none; color:#e74c3c; cursor:pointer; font-weight:bold;">Ø®Ø±ÙˆØ¬ ğŸšª</button>
        </div>
    </header>

    <div class="dashboard-container">
        
        <div class="form-card">
            <div class="card-header">
                <h3>ğŸ›’ Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
            </div>
            
            <div class="input-group">
                <label>ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ù…Ù† ÙˆÙŠÙ†ØŸ)</label>
                <input type="text" id="pickup" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø±Ø¨ÙŠØŒ Ø¹Ù…Ø§Ø±Ø© Ø§Ù„Ø°Ù‡Ø¨">
            </div>

            <div class="input-group">
                <label>ğŸ Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„ (Ù„ÙŠ ÙˆÙŠÙ†ØŸ)</label>
                <input type="text" id="dropoff" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„ÙØªÙŠØ­Ø§Ø¨ØŒ Ù…Ø±Ø¨Ø¹ 5">
            </div>

            <div class="input-group">
                <label>ğŸ“¦ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ (Ø´Ù†Ùˆ Ø§Ù„Ù…Ø´ÙˆØ§Ø±ØŸ)</label>
                <textarea id="details" rows="3" placeholder="Ù…Ø«Ø§Ù„: ØªÙˆØµÙŠÙ„ Ø¸Ø±Ù Ù…Ø³ØªÙ†Ø¯Ø§ØªØŒ Ø£Ùˆ Ø·Ù„Ø¨ÙŠØ© Ø£ÙƒÙ„..."></textarea>
            </div>

            <div class="input-group">
                <label>ğŸ’° Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­ (Ø¬Ù†ÙŠÙ‡)</label>
                <input type="number" id="price" placeholder="Ù…Ø«Ø§Ù„: 3000">
            </div>

            <button class="btn-block btn-primary" onclick="createOrder()">ğŸš€ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
        </div>

        <div style="margin-top: 20px; text-align: center;">
            <a href="client-my-orders.html" class="btn-hero" style="background: var(--secondary); color: white; padding: 10px 20px; font-size: 1rem;">ğŸ“‹ Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</a>
        </div>

    </div>

<script>
    const token = localStorage.getItem('clientToken');
    const userName = localStorage.getItem('userName');

    if (!token) window.location.href = 'client-login.html';
    
    // Ø¹Ø±Ø¶ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if(userName) document.getElementById('welcome-msg').innerText = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${userName}`;

    function logout() {
        localStorage.removeItem('clientToken');
        window.location.href = 'client-login.html';
    }

    async function createOrder() {
        const pickupLocation = document.getElementById('pickup').value;
        const dropoffLocation = document.getElementById('dropoff').value;
        const price = document.getElementById('price').value;
        const details = document.getElementById('details').value;

        if (!pickupLocation || !dropoffLocation || !price) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
            return;
        }

        try {
            const res = await fetch('/api/orders', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + token
                },
                body: JSON.stringify({ pickupLocation, dropoffLocation, price, details })
            });

            if (res.ok) {
                alert('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠÙ‚Ø¨Ù„ Ø§Ù„ÙƒØ§Ø¨ØªÙ† Ø·Ù„Ø¨Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.');
                window.location.href = 'client-my-orders.html'; // ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
            } else {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨');
            }
        } catch (err) {
            console.error(err);
            alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„');
        }
    }
</script>

</body>
</html>
