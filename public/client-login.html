<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฏุฎูู ุงูุนููุงุก | ูุตู-ูู</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;900&display=swap" rel="stylesheet">
</head>
<body>

<div class="auth-container">
    <div class="auth-box">
       <a class="logo">
    <img src="logo.png" alt="ุดุนุงุฑ ูุตู-ูู" s> </a>
        
        <h2>ุฃููุงู ุจู! ๐</h2>

        <div id="alert-box" style="display:none; padding: 10px; margin-bottom: 15px; border-radius: 5px; font-weight: bold; text-align: center;"></div>
        
        <div class="input-group">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="email" placeholder="name@example.com">
        </div>
        
        <div class="input-group">
            <label>ูููุฉ ุงููุฑูุฑ</label>
            <input type="password" id="password" placeholder="******">
        </div>

        <button class="btn-block btn-primary" onclick="login()">ุชุณุฌูู ุงูุฏุฎูู</button>
        
        <div style="margin-top: 20px; font-size: 14px;">
            <p><a href="forgot-password.html" style="color: #7f8c8d;">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a></p>
            <p>ุฌุฏูุฏ ูุนูุงุ <a href="client-register.html" style="color: var(--primary); font-weight: bold;">ุฃูุดุฆ ุญุณุงุจ ุฌุฏูุฏ</a></p>
        </div>
    </div>
</div>

<script>
    // ุฏุงูุฉ ูุฅุธูุงุฑ ุงูุชูุจููุงุช ุงูููููุฉ
    function showAlert(msg, type) {
        const box = document.getElementById('alert-box');
        box.style.display = 'block';
        box.innerText = msg;
        
        if (type === 'success') {
            // ููู ุฃุฎุถุฑ ูููุฌุงุญ
            box.style.backgroundColor = '#d4edda';
            box.style.color = '#155724';
            box.style.border = '1px solid #c3e6cb';
        } else {
            // ููู ุฃุญูุฑ ููุฎุทุฃ
            box.style.backgroundColor = '#f8d7da';
            box.style.color = '#721c24';
            box.style.border = '1px solid #f5c6cb';
        }
    }

    async function login() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        // ุฅุฎูุงุก ุงูุชูุจูู ุงููุฏูู ุนูุฏ ุงููุญุงููุฉ ุงูุฌุฏูุฏุฉ
        document.getElementById('alert-box').style.display = 'none';

        try {
            const res = await fetch('http://localhost:5000/api/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password }) 
            });

            const data = await res.json();

            if (res.ok) {
                // ุงูุชุฃูุฏ ูู ุฃู ุงูุฏูุฑ ูู ุนููู (Client)
                if (data.user.role === 'client' || data.user.role === 'customer') {
                    // โ 1. ุฅุธูุงุฑ ุฑุณุงูุฉ ุงููุฌุงุญ ุงูุฎุถุฑุงุก
                    showAlert("ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ! ๐", "success");

                    // 2. ุญูุธ ุงูุจูุงูุงุช
                    localStorage.setItem('clientToken', data.token);
                    localStorage.setItem('userName', data.user.name);

                    // 3. ุงูุงูุชุธุงุฑ ุซุงููุชูู ุซู ุงูุชุญููู (ูููุฑุฃ ุงููุณุชุฎุฏู ุงูุฑุณุงูุฉ)
                    setTimeout(() => {
                        window.location.href = 'client-orders.html';
                    }, 2000);
                } else {
                    showAlert("ุนุฐุฑุงูุ ูุฐุง ุงูุญุณุงุจ ููุณ ุญุณุงุจ ุนููู", "error");
                }
            } else {
                // โ ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูุญูุฑุงุก (ูู ุงูุณูุฑูุฑ)
                showAlert(data.message || 'ุจูุงูุงุช ุงูุฏุฎูู ุบูุฑ ุตุญูุญุฉ', "error");
            }
        } catch (err) {
            showAlert("ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ", "error");
        }
    }
</script>

</body>
</html>